---
layout: post
title: '"Copiando" una base de datos DB2'
date: '2010-09-10T10:53:00.000-03:00'
author: Norberto Herz
tags: 
modified_time: '2010-09-10T12:53:23.509-03:00'
blogger_id: tag:blogger.com,1999:blog-8314627212095006227.post-1658508502414253654
blogger_orig_url: http://ourbit.blogspot.com/2010/09/copiando-una-base-de-datos-db2.html
---

Si algo tiene DB2 (de bueno y de malo) es que para realizar casi cualquier operación, existen muchas maneras diferentes de hacerlo (más de las necesarias quizas). Pero esto lleva a tener que conocer las diferentes precondiciones para cada procedimiento.<div>En este caso, algo que debería ser sencillo, puede resultar un poco engorroso (la documentación está dando vueltas por allí, pero algo desorganizada). </div><div>¿Como copiar una base de datos? Existen diversas maneras de hacerlo.</div><div><ul><li>Opción 1: Backup &amp; Restore: Esta opción es útil cuando se quiera realizar una copia de seguridad para ser restaurada más tarde en el mismo server del cual se origina, o incluso, en máquinas con características similares (sobretodo, sistema operativo). Existen 2 tipos, pero más allá de sus diferencias técnicas, quiero hacer hincapié en sus pre-requisitos y sus pos-condiciones:<ul><li>Online Backup: La principal ventaja, es que no existe la necesidad de desconectar todas las aplicaciones que estén haciendo uso de la base de datos. Una desventaja: NO SE PUEDE RESTAURAR EN UN ENTORNO CON DISTINTO SISTEMA OPERATIVO (y por este motivo empezó mi búsqueda).</li><li>Offline Backup: No tiene el problema de la restauración en otras plataformas, pero, claro está, necesita que todas las aplicaciones que estén accediendo a la base, cierren sus conexiones. (Nota: para saber que aplicaciones tienen conexión, ver el comando db2 list applications).</li></ul></li><li>Opción 2: DB2move: Estando en el entorno de la base que quiere hacer copiada, DB2move <database> export, realiza una exportación de todos los datos, generando una buena cantidad de archivos dentro de la carpeta donde se ejecuta el comando. Luego, haciendo DB2move <database> load, estando en la carpeta que contiene los archivos, los datos se cargan a la base de datos indicadas. He aquí, que esa base, debe existir y tener la misma estructura de tablas y schemas que la original (incluso constrains). Afortunadamente, esto es facil de obtener también: db2look -d <database> -e -a -o <file> genera el DDL y lo almacena en el file especificado (usando la base de datos, pero no creandola). Luego, Creando la base de datos (CREATE command) y corriendo db2 -tvf <file>, somos capaces de crear la estructura de base de datos, para luego poder correr el db2move <database> load que terminará de importar los datos.</li></ul>Pasando en limpio, los pasos de esta segunda opción serían:</div><div>1. Generar el DDL: db2look -d <database> -e -a -o <file></div><div>2. Generar el export de datos: db2move <database> export</div><div>3. Suponiendo que estamos conectados a un servidor remoto y queremos pasarlo a alguna otra terminal, copiar la carpeta con el archivo con ddl y los exports a la nueva terminal.</div><div>4. En la terminal, db2 create database <database></div><div>5. Generar la estructura: db2 -tvf <file></div><div>5. Importar los datos: db2move <database> load</div><div>
<br /></div><div>Todos los comandos de DB2 tienen infinidad de opciones, y los mencionados no son la excepción, pero para simplificar, preferí ir directo al punto. En los links adjuntos, paso algunas fuentes que usé, y siempre pueden ver la documentación de TODOS los comandos de DB2 en <a href="http://www.ibm.com/developerworks/data/library/techarticle/dm-0406dang/index.html">http://www.ibm.com/developerworks/data/library/techarticle/dm-0406dang/index.html</a> .</div><div>
<br /></div><div>Links útiles:</div><div><a href="http://www.ibm.com/developerworks/data/library/techarticle/pworld/0112mccluney.html">Backup &amp; Restore</a></div><div><a href="http://www.ibm.com/developerworks/data/library/techarticle/dm-0403melnyk/index.html">DB2 cloning databases across different platforms</a></div><meta equiv="content-type" content="text/html; charset=utf-8">