---
layout: post
title: '#SOA #REST sobre #cakePHP, consumido por #jQuery'
date: '2011-06-01T00:29:00.000-03:00'
author: nohorbee
tags:
- REST
- JQuery
- Architecture
- XML
- CAKEPHP
- PHP
- Jscript
- WebServices
- SOA
- RIA
- JSON
- WEB
modified_time: '2011-06-01T00:44:43.530-03:00'
blogger_id: tag:blogger.com,1999:blog-8314627212095006227.post-5390784506812132579
blogger_orig_url: http://ourbit.blogspot.com/2011/05/soa-rest-sobre-cakephp-consumido-por.html
---

<meta equiv="content-type" content="text/html; charset=utf-8"><div style="background-color: transparent; margin-top: 0px; margin-left: 0px; margin-bottom: 0px; margin-right: 0px; "><span class="Apple-style-span"><meta equiv="content-type" content="text/html; charset=utf-8"><div style="background-color: transparent; margin-top: 0px; margin-left: 0px; margin-bottom: 0px; margin-right: 0px; "><h2><span class="Apple-style-span" ><span class="Apple-style-span" style="white-space: pre-wrap;"><meta equiv="content-type" content="text/html; charset=utf-8"><span class="Apple-style-span" style="font-size: 15px; font-weight: normal; ">Post cargadito. Recomendación del autor: Cafecito y media horita para leer en detalle. </span></span></span></h2><h2 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 18pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Introducción</span></h2><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Lo más dificil de este POST fue escribir un título que refleje el contenido. Creo que no lo logré, y por eso estas primeras líneas intentaran explicar el por qué de la mezcla de temas.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Conociendo los conceptos básicos de REST, y necesitando desarrollar una aplicación por mi cuenta (es decir, sin restricciones corporativas de ningún tipo), decidí profundizar en estos conceptos y llevarlos a la práctica. Cuando quiero desarrollar un proyecto rápido, sin necesidades particulares de performance y escalabilidad, elijo PHP por la simpleza del start up principalmente (luego, si el proyecto crece, evalúo migrar de tecnología). Habiéndo trabajado previamente con cakePHP (de una manera muy básica) decidí profundizar también en su utilización como MVC, no sin antes investigar acerca de su soporte a REST. Consumir los servicios generados mediante jQuery, persigue el objetivo de lograr una RIA (Rich Internet Application) y la elección del framework responde solamente al gusto y la necesidad también de profundizar mis conocimientos sobre el mismo (otros proyectos me han llevado a conocer extJS y DOJO) y quería extenderme en jQuery y jQuery UI.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">En definitiva (y también a modo de advertencia) lo único que tienen en común estos tópicos, es que no soy experto en ninguno de ellos, lo cual podría llevar a una pregunta final: ¿Por qué escribir sobre algo que hasta hace poco tiempo fue desconocido, y en lo que claramente no soy experto? Simple:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">1. Me costó bastante trabajo encontrar buena documentación acerca de REST sobre cakePHP. La documentación oficial está sencillamente incompleta, y las mismas preguntas que me surgieron a mi, le surgieron a muchas personas, pero las respuestas no se encontraban fácilmente.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">2. REST en si mismo, se basa en la </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">simpleza</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> de reutilizar un protocolo existente, evitando sumar una complejidad que desde su punto de vista se considera innecesaria (haciendo referencia al típico esquema SOAP y los WSDL). Dicho esto, creo que sería un contrasentido buscar un experto REST. Tal cosa no debería existir.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">3. ¿Es necesario algo más? No. Esto es un aporte. Agregaría que preferí JSON sobre XML por conocer mi primer destino: JavaScript, no sin antes investigar la posibilidad de utilziar ambos métodos de representación sin mayor complejidad.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Finalmente, y viendo que esto podía ponerse algo largo, me preguntaba si escribir varios Posts abordando los temas de forma incremental, o separar un solo Post en pequeños capítulos. Opté por la segunda opción para evitar al lector la necesidad de linkear diferentes Posts para obtener el concepto general. Claramente, </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">estos capítulos son escritos en un orden particular, pero deberían ser salteados si el lector se considera cómodo con su contenido</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Intentaré mantener los highlights, bolds, etc para llamar la atención del lector cuando sea realmente necesario.</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Comencemos entonces.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h2 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 18pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">SOA y REST</span></h2><h3 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 14pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">RINS &amp; SINR (REST is not SOA &amp; SOA is not REST)</span></h3><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Es una pequeña aclaración que me permito hacer, no en defensa de uno ni de otro, sino como una forma de diferenciación. SOA (Services Oriented Architecture) es una arquitectura y metodología para el desarrollo de aplicaciones desacopladas (algo que ambos tienen en común). Pero cuando hablamos de SOA, también solemos mencionar que los servicios no son necesariamente Webservices. SOA puede hacer referencia a separación de capas de una aplicación, comunicación de aplicaciones de empresa (Enterprise Applications), Orquestación (generalmente utilizando motores de reglas de negocios), monitoreo (obtención de métricas, KPIs), procesos de negocio, y toda la suite. REST en cambio, apunta a un objetivo particular (y quizas menos ambicioso). Exponer servicios. O mejor dicho, exponer recursos.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h3 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 14pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">REST</span></h3><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Partiendo de un concepto bien abstracto, </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">REST basa su funcionamiento en la publicación de recursos</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">. En una aplicación, un recurso suele coincidir con una entidad: Usuario, Cliente, Factura, Evento, etc. Puede que sea una sutileza, pero mientras que al utilizar SOAP, solemos definir el webservice mediante un WSDL de forma tal que el servicio sea una acción, a la que se le pasan parametros, devolviendo información (traerClientes(‘que hayan realizado compras en el año actual’)), REST intenta definir al Cliente como un recurso, y en última instancia, existirá una acción “TRAER” parametrizable. Pero no son los primeros ejemplos que suelen verse en REST. REST nos dice: Si queremos obtener todos nuestros clientes, llamaremos a …../clientes/ . Si queremos al cliente con ID 1, llamaremos a …../clientes/1 . Incluso, dentro de los primeros ejemplos, si queremos especificar un formato, lo hacemos como si nos refiriesemos a un archivo: cliente/1.xml o cliente/1.json (para no quedarnos en lo meramente dogmático, consideremos también cliente/1.csv y cliente/1.miformatopropietario). </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Finalmente, vemos como los ejemplos se asemejan a una URL web. Esto no es accidental, ya que el enfoque de REST, se basa en reutilizar el protocolo HTTP (y nos referimos principalmente a sus “métodos”) para conocer las operaciones a realizar sobre el recurso.</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> De esta manera, considerando que mi aplicación corre en </span><a href="http://example.ourbit.com/" style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 153); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; ">http://example.ourbit.com</span></a><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> y la capa de servicios se encuentra en </span><a href="http://example.ourbit.com/services" style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 153); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; ">http://example.ourbit.com/services</span></a><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> , podríamos establecer que:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span><table style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; border-width: initial; border-color: initial; border-collapse: collapse; width: 624px; "><colgroup><col width="*"><col width="*"></colgroup><tbody><tr style="height: 0px; "><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: dotted; border-right-style: dotted; border-bottom-style: dotted; border-left-style: dotted; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); vertical-align: top; padding-top: 7px; padding-right: 7px; padding-bottom: 7px; padding-left: 7px; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">GET http://example.ourbit.com/services/clientes/1.json</span></td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: dotted; border-right-style: dotted; border-bottom-style: dotted; border-left-style: dotted; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); vertical-align: top; padding-top: 7px; padding-right: 7px; padding-bottom: 7px; padding-left: 7px; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Obtiene el cliente con Id 1 y devuelve en formato JSON</span></td></tr><tr style="height: 0px; "><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: dotted; border-right-style: dotted; border-bottom-style: dotted; border-left-style: dotted; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); vertical-align: top; padding-top: 7px; padding-right: 7px; padding-bottom: 7px; padding-left: 7px; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">GET http://example.ourbit.com/services/clientes/.xml</span></td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: dotted; border-right-style: dotted; border-bottom-style: dotted; border-left-style: dotted; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); vertical-align: top; padding-top: 7px; padding-right: 7px; padding-bottom: 7px; padding-left: 7px; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Obtiene todos los clientes en formato XML</span></td></tr><tr style="height: 0px; "><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: dotted; border-right-style: dotted; border-bottom-style: dotted; border-left-style: dotted; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); vertical-align: top; padding-top: 7px; padding-right: 7px; padding-bottom: 7px; padding-left: 7px; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">POST http://example.ourbit.com/services/clientes/parametro1/parametro2/.../parametroN</span></td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: dotted; border-right-style: dotted; border-bottom-style: dotted; border-left-style: dotted; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); vertical-align: top; padding-top: 7px; padding-right: 7px; padding-bottom: 7px; padding-left: 7px; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Crea un nuevo cliente utilizando los parámetros</span></td></tr><tr style="height: 0px; "><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: dotted; border-right-style: dotted; border-bottom-style: dotted; border-left-style: dotted; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); vertical-align: top; padding-top: 7px; padding-right: 7px; padding-bottom: 7px; padding-left: 7px; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">PUT http://example.ourbit.com/services/clientes/1/parametro1/parametro2/.../parametroN </span></td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: dotted; border-right-style: dotted; border-bottom-style: dotted; border-left-style: dotted; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); vertical-align: top; padding-top: 7px; padding-right: 7px; padding-bottom: 7px; padding-left: 7px; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Modifica al cliente 1 utilizando los parámetros</span></td></tr></tbody></table>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">De manera análoga, </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">REST indica que deberíamos utilizar los HTTP status para indicar la respuesta (además de los datos, si existieran).</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> Por ejemplo, si buscáramos el cliente con ID 1 y no lo encontráramos, deberíamos responder con un error 404. Si ocurriera un problema en la aplicación, lo correcto sería devolver un error 500. Si no se contara con privilegios suficientes para acceder a un recurso particular, el error 403 debería ser devuelto (por mencionar algunos ejemplos). Incluso, si la petición es respondida correctamente, esta respuesta debería incluir un HTTP Status 200. </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">La devolución de estos códigos se hace mediante el seteo de los headers de HTTP. </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Cada lenguaje que implementa el protocolo, provee las funciones necesarias para hacerlo. Más adelante, veremos como lo hace PHP.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Dada esta vista general de </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">REST</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">, vale aclarar que, siendo este un modelo arquitectónico, </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">implementarlo no es otra cosa que atender las peticiones HTTP, con el formato “convencional” y dar las respuestas esperadas.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Finalmente, y siendo este un concepto que va más allá de REST, la utilización de “Servicios”, en este caso “WebServices” </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">nos permite desacoplar aplicaciones o incluso, distintas capas de una misma aplicación</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">. Ej.: Un sitio Web puede acceder a toda la capa de negocios mediante la invocación de WebServices. Estos WebServices podrán ser consumidos también por una aplicación de escritorio, teléfonos celulares, o cualquier otro dispositivo.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h2 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 18pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">CakePHP</span></h2><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Es un framework basado en el patrón MVC (o su adaptación WEB), de la familia de los denominados “Rapid Frameworks”. </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Implementa el modelo “Convention over Configuration”,</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> lo que indica que se pueden seguir las convenciones definidas por el mismo para obtener de forma rápida una aplicación, pero puede extenderse su funcionalidad mediante configuración para ejecutar lógicas tan complejas como se desarrollen.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">En forma resumida, el patrón MVC (del cual escribiré un POST aparte en algun momento), se basa en 3 componentes principales: Model-View-Controller.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">- View: Componentes encargados del despliegue de la interfaz. Llaman al Controller para ejecutar “acciones” especificadas por el usuario.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">- Controller: Actua de punto de entrada a funcionalidades, maneja las reglas de navegación, y ejecuta lógicas de validación, formateo de datos, etc.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">- Model: Es el modelo en si mismo (conocido también como la “capa de negocios” de la aplicación).</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h3 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 14pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Convención CakePHP</span></h3><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Una visión simplificada de CakePHP (quizas intentando entenderlo como una API a utilizar), consiste en respetar la convención indicada para crear los componentes de Model-View-Controller, e incluso las entidades en base de datos. De esta manera, por ejemplo, puedo crear la tabla “clients”, con los campos: “id”, “name”, “address”. Luego, una clase “Client” (comenzando con mayúscula y en singular, contenida en un archivo llamado client.php). Automágicamente, esta clase contendrá (aunque no aparezcan en el código), atributos correspondientes a los campos de la base de datos, y algúnos métodos del tipo “find”, “findBy<field>”, etc. Esta clase, será parte del modelo (y de hecho, debe crearse en una carpeta particular llamada Model).</field></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Ahora bien, para solicitar al modelo, una instancia particular de alguna entidad, debe haber algún componente que lo solicite. Según el patrón MVC, esto ocurrirá en el controller</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">. En CakePHP, el controller es una clase (nomenclada en este caso como ClientsController, contenida en un archivo llamado clients_controller.php). Esta clase contendrá generalmente los métodos básicos que responden a un CRUD (Create, Read, Update, Delete), aunque podrían crearse tantos métodos como sean necesarios. Cabe destacar, que </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">al acceder por URL a una funcionalidad montada sobre  cakePHP, lo primero en ejecutarse es el controller, que llamará al model, y luego de setear alguna variable con su resultado, invocará a la vista correspondiente que sabrá realizar el despliegue de las entidades obtenidas.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Finalmente, la vista, es un archivo de extensión CTP, ubicado en la carpeta views/entidad. En este caso, views/client/index.ctp , corresponde a la vista por default a ser invocada por ClientController::index(). De manera sencilla, podemos definir la vista a ser invocada por un controller (sobreescribiendo la convención con configuración, como se explica en secciones posteriores).</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Para la perspectiva REST, lo explicado sobre el MODEL no varía en absoluto. Las principales dependencias se darán con el Controller (una URL mapeará a un controller determinado), y el formato especificado en dicha URL, especificará la vista a invocar.</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h3 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 14pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Rest sobre CakePHP</span></h3><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Creo que con lo ya dicho sobre Rest, y luego sobre CakePHP, la forma de implementar REST mediante CakePHP se cae de maduro. O al menos, es casi obvio lo que querríamos pedirle a la convención de CakePHP. </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Si me llega una URL del estilo: </span><a href="http://example.ourbit.com/services/clientes/1.json" style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 153); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; ">http://example.ourbit.com/services/clients/1.json</span></a><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> , me gustaría que cakePHP invoque a ClientsController::view(1), y al invocar la vista, que solicite aquella que devuelva las entidades en formato JSON.</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> Sin ningún framework de por medio, deberíamos realizar un parse de la URL, y en base a ello, llamar a alguna lógica. Esto, si bien no es demasiado complejo, puede ser laborioso y desde ya, dos aplicaciones diferentes solo tendrán un ciclo de vida convencional de casualidad.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Aquí está la primera buena noticia. </span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">CakePHP soporta REST</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">. Basta incluir algunas líneas en los archivos de configuración para que el mapeo URL&lt;-&gt;Controller ocurra. En tanto para las vistas, basta con que al realizar el despliegue, en lugar de dibujar un HTML, devuelva XML, JSON (o el formato requerido) y realice un cambio en el content-type (modificando el header HTTP).</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Estos pasos se encuentran documentados en el sitio de </span><a href="http://book.cakephp.org/es/view/1238/REST" style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 153); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; ">CakePHP</span></a><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">. Basicamente:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">- Agregar al archivo .../cakephp/app/config/routes.php las líneas:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>Router::mapResources('clients'); // para cada entidad que deseemos mapear.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>Router::parseExtensions('xml','json'); // para definir los formatos soportados. Si no se <span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>especifica ninguno, XML es el formato soportado por defecto.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">- Crear las vistas: Al crear las vistas, /views/clients/xml/method.ctp -&gt; invocada para el formato XML del método method de ClientsController. Su contenido podría ser:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span><clients></clients></span>
<br /><p style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; margin-left: 36pt; text-indent: 36pt; margin-top: 0pt; margin-bottom: 0pt; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><!--?php echo $xml--->serialize($clients)?&gt;<span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span></span></p><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Importante (Esto no está correctamente documentado): Al hacer lo propio con otros formatos, por ejemplo JSON, podría no funcionar como esperado. Para completar la disponibilidad de un formato, se debe crear .../views/layouts/<formato>/default.ctp (en este caso, formato sería json) y su contenido:</formato></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span></span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><!--?php</span-->
<br /><p style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">header("Pragma: no-cache");</span></p><p style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">header("Cache-Control: no-store, no-cache, max-age=0, must-revalidate");</span></p><p style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">header('Content-Type: application/json');</span></p><p style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">header("X-JSON: ".$content_for_layout);</span></p><p style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "> </span></p><p style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">echo $content_for_layout;</span></p><p style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt; "><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">?&gt;</span><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "></span></p><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h3 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 14pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Utilidades CakePHP</span></h3><h4 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 12pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Reutilización de vistas</span></h4><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Al comenzar a desarrollar, noté que mi aplicación tenía distintos métodos que obtenían una lista de una entidad X. Por ejemplo:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">- Obtener Clientes (todos).</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">- Obtener Clientes que hayan comprado en el último mes.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">- Obtener Clientes que presenten deudas.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Estas tres operaciones, son atendidas por tres métodos distintos de ClientsController. Por defecto, CakePHP invocaría a tres vistas diferentes. Ahora bien, estas vistas harían lo mismo. Tomarían la variable que contiene la lista de clientes, y la devolverían en formato XML, JSON, etc.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Sería deseable entonces, tener una sola vista invocada por estos tres métodos. Para especificar manualmente, la vista a invocar (sobreescribiendo la convención con la configuración), basta con especificar antes del fin del método: $this-&gt;render('nombreDeLaVista'); (siendo la vista, nombreDeLaVista.ctp).</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h4 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 12pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Reutilizar funcionalidades dentro de una vista</span></h4><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Es deseable también en algunos casos, poder incluir un “componente” dentro de diferentes vistas. Es decir, reutilizar cierta funcionalidad en varias vistas. Por ejemplo: Si quisiera imprimir en todos los XMLs un código común, o como en mi caso, setear el Access-Control-Allow-Origin para filtrar los dominios que pueden invocar un determinado servicio.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Para lograrlo, CakePHP nos provee del concepto de ELEMENTS. Dentro de la carpeta views, existe una subcarpeta llamada elements. Aquí puedo colocar miElemento.ctp, que es el archivo con la funcionalidad a reutilizar. Para invocarlo desde otras vistas, basta con incluir en las mismas: $this-&gt;element('miElemento'); (Sin la extensión ctp).</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">En el ejemplo de la aplicación, dentro de /views/elements, ubiqué el elemento acao.ctp siendo su contenido:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><!--?</span-->
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">if (Configure::read('Security.acao.enabled')) {</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>if(!isset($_SERVER['HTTP_ORIGIN'])) {header("HTTP/1.1 403 Access Forbidden");die();}</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>$acaoDomains = Configure::read('Security.acao.domains');</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>header('Access-Control-Allow-Origin: ' . $acaoDomains[$_SERVER['HTTP_ORIGIN']]);</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">} else {</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>header('Access-Control-Allow-Origin: *');</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">}</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">?&gt;</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">y en las vistas donde quería aplicarlo: $this-&gt;element('acao');</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">El contenido de la propiedad ‘Security.acao.enabled’ es seteado en .../cakephp/app/config/core.php de la siguiente manera:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Configure::write('Security.acao.domains', $acaoDomains);</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Nota: No confiar en el método descripto, como una manera confiable de segurizar nuestros servicios. La variable de servidor ‘HTTP_ORIGIN’ es falseable de maneras muy sencillas.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h2 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 18pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Cliente jQuery</span></h2><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Esto no constituye una parte central de la temática planteada, pero es bueno plantear el ejemplo para ver la utilidad de realizar una orientación a servicios, o más precisamente: Publicar una API a ser consumida por un cliente.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">REST, nos dió una forma sencilla de publicar una API. CakePHP nos proveyó de una implementación REST. Gracias a esto, podemos desarrollar distintas presentaciones de nuestra aplicación, reutilizando INTEGRAMENTE la lógica de negocio. jQuery podría considerarse como una capa de abstracción de JavaScript. Funcionalidades que antes eran complejas de desarrollar, con jQuery se simplifican. Un gran ejemplo de esto, es la manera de realizar llamadas AJAX. Simplemente:</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">$.ajax({</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>url: "<!--?=SERVICES_URL?-->clients/1.json",   // especificamos la URL del servicio</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>success: function( data ) {   // Al ser asincrónico, definimos la función a ejecutar cuando <span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>finalice la ejecución del serivicio. data, contendrá lo <span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>expuesto por el servicio.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>response( $.map( data, function( item ) {   // Mapeo de la data JSON en item</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>return {</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>label: item.Client.name,</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>value: item.Client.id,</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>}</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span><span class="Apple-tab-span" style="white-space: pre; ">	</span>}));</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; "><span class="Apple-tab-span" style="white-space: pre; ">	</span>}</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">});</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Como fue dicho anteriormente, esto es solo un ejemplo de como llamar a una URL mediante jQuery. Notese que desde el lado del cliente, es indistinto si del otro lado hay PHP, si se usa CakePHP, JAVA, o cualquier otra tecnología. Solo orientamos al servicio y a los datos devueltos.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Cambiar la capa de presentación NO IMPACTA EN ABSOLUTO los servicios expuestos.</span>
<br /><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; font-size: 11pt; background-color: transparent;"></span>
<br /><h2 style="font-family: 'Times New Roman'; font-size: medium; white-space: normal; "><span style="font-size: 18pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: bold; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">Conclusión</span></h2><span style="font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: normal; font-style: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap; ">No hace falta ser un experto para implementar una aplicación en CakePHP, y poder publicar su API respetando el modelo arquitectónico REST. Sin embargo, esta simple labor, nos permite implementar soluciones orientadas a servicios en las cuales la vista se encuentra totalmente desacoplada del modelo. Un equipo de desarrollo podría definir la API de la capa negocios, y luego desarrollar en paralelo distintos clientes e incluso dicho modelo.</span></span></span></div></span></div>